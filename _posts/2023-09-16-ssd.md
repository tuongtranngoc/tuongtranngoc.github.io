---
title: 'SSD: Single Shot MultiBox Detector'
date: 2023-09-16
permalink: /posts/2023/ssd/
tags:
  - Computer Vision
  - Object Detection
  - Image Processing
---

In the object detection algorithm series, I will brifely give a high-level description of everything you need to know about the Pytorch's implementation of SSD algorithm as described on the [SSD: Single Shot MultiBox Detector](https://arxiv.org/abs/1512.02325) paper

## How does SSD works

SSD uses small convolutional filters applied to feature maps to predict category scores and box offsets for a fixed set of default bounding boxes. To detect objects of different sizes, SSD outputs predictions from feature maps of different scales and explicitly separates predictions by aspect ratio.

During training, we need to first match the groundtruth to the default bounding boxes and then using those matches to estimate the loss function. During inference time, similar prediction boxes are combined to estimate the final predictions.

<head>
    <style type="text/css">
        figure{text-align: center;}
        math{text-align: center;}
    </style>
</head>

<figure>
    <img src='/images/posts/ssd/detection_examples_coco.jpg'>
</figure>

## The Single Shot MultiBox Detector (SSD)
This section decribes the components of SSD architecture

### DefaultBoxes Generator
To handle difference object scales, SSD use both the lower and upper feature map for detection. Based on pre-defined feature sizes, the algorithm create a set of default bounding boxes of different espect ratios at each location.

<figure>
    <img src='/images/posts/ssd/ssd_framework.jpg'>
</figure>

We want to use $m$ feature maps for detection, the scales of default boxes for each feature map is computed as:

$s_k=s_{min} + \frac{s_{max}+s_{min}}{m-1} (k-1), k\in [1, m]$

where $s_{min}=0.2$ and $s_{max}=0.9$, and different espect ratios for default boxes denote as $a_r = \{1, 2, 3, \frac{1}{2}, \frac{1}{3}\}$. The width, height and center for each default box is computed as:

$w_k=s_k*\sqrt{a_r}, w_h=s_k/\sqrt{a_r}, cx_k=\frac{i+0.5}{\vert{f_k}\vert}, cy_k=\frac{j+0.5}{\vert{f_k}\vert}$

where $\vert{f_k}\vert$ is the size of the k-th square feature map, $i,j \in [0, \vert{f_k}\vert)$
